# 从风险感知到游客决策：核废水排放对赴日旅游的事件分析研究

## 1. 项目简介

项目是2024年秋季课程《环境经济与政策研究前沿》课程论文《从风险感知到游客决策：核废水排放对赴日旅游的事件分析研究》的代码仓库。
研究旨在探讨核废水排放事件对游客决策的影响机制，特别是对中国游客赴日旅游流动的动态影响。研究基于风险感知理论与危机管理理论，采用事件分析法结合时间序列分析，创新性地引入社交媒体数据（微博）和情感分析技术，构建了一个系统化的计算框架，用于量化游客的风险感知水平（Risk Perception Intensity Score, RPIS）。
通过挖掘社交平台上的用户生成内容，本研究实现了对游客风险感知的动态测量和建模，克服了传统研究方法在捕捉游客主观心理波动方面的局限性。
## 2. 研究方法

本研究采用**事件分析法 (Event Study Method)** 作为核心研究方法，并结合了以下技术：

* **数据爬取**: 使用Python爬虫框架，从微博平台采集与“日本旅游”相关的用户生成内容（UGC），时间跨度为2021年4月至2023年12月。
* **文本分析与情感量化**:
    * 构建了针对“核废水排放事件的旅游风险感知词典” (`RiskWord.xlsx`)。
    * 使用`jieba`分词库对微博文本进行处理。
    * 通过词典匹配计算每条文本的**风险感知强度得分 (RPIS)**，以量化游客的风险感知水平。
* **时间序列分析**:
    * 使用**ARIMA模型**对赴日旅游人数建立基准预测模型。
    * 通过计算**异常变化 (Abnormal Change)** 和**累计异常变化 (Cumulative Abnormal Change, CAC)**，评估核废水排放事件对旅游人数的实际影响。
* **回归分析**: 构建OLS回归模型，探究社交媒体中的风险感知强度 (RPIS) 对旅游人数异常变化的具体影响。

## 3. 代码文件说明

项目代码主要分为数据采集和数据分析两部分。

### 3.1 数据采集 (`/crawl/`)

数据采集部分负责从微博平台获取原始数据，包括博文、评论等。

* `base_setting.py`: 基础配置文件，包含请求头（headers）、cookies以及`mid`和`url`转换等通用函数。
* `优化代码_1_获取博文id.py`: 设定关键词和时间范围，从微博搜索结果中批量获取博文ID（`mid`）。
* `优化代码_2_获取博文详情.py`: 根据获取的博文ID，抓取每条博文的具体内容、作者、是否为长文本等详细信息。
* `优化代码_3_采集一级评论.py`: 抓取博文下的一级评论数据。
* `优化代码_4_采集二级评论.py`: 抓取一级评论下的二级评论数据。
* `合并最终结果.py`: 将采集到的博文详情、一级评论和二级评论数据进行清洗、合并和规范化，最终整合成一个完整的Excel表格，供后续分析使用。

### 3.2 数据处理与分析 (`/data_processing/`)

这部分代码用于对采集到的数据进行处理、计算风险感知得分和执行事件分析。

* `RiskWord.xlsx - Sheet1.csv`: 本研究构建的风险感知词汇词典，用于后续的文本情感量化。
* `rispscore_output.py`: **RPIS计算模块**。读取清洗后的文本数据和风险词典，通过`jieba`分词和词频统计，计算每条文本的RPIS得分，并按月汇总生成加权平均RPIS得分，对应论文中4.1部分的工作。
* `eventanalysis.py`: **事件分析模块**。整合游客人数时间序列数据和计算出的RPIS月度数据，使用`statsmodels`和`pmdarima`库建立ARIMA模型进行预测，计算异常变化和累计异常变化，并进行回归分析和结果可视化，对应论文中4.3部分的工作。
* `dataframe_output.py`: 用于处理Excel文件中的时间格式，确保数据规范性。
* `uml_output.py`: 用于生成特定时间范围内的微博搜索URL。

## 4. 如何运行

1.  **环境配置**:
    * 安装Python 3.x。
    * 安装所需依赖库:
        ```bash
        pip install pandas requests lxml tqdm numpy retry openpyxl jieba statsmodels pmdarima matplotlib seaborn
        ```

2.  **更新Cookies**:
    * 在 `crawl/base_setting.py` 文件中，替换 `headers` 字典里的 `cookie` 为您自己登录微博后获取的有效Cookie，否则无法成功爬取数据。

3.  **执行数据采集**:
    * 依次运行 `crawl` 文件夹下的Python脚本：
        1.  `优化代码_1_获取博文id.py`
        2.  `优化代码_2_获取博文详情.py`
        3.  `优化代码_3_采集一级评论.py`
        4.  `优化代码_4_采集二级评论.py`
        5.  `合并最终结果.py`
    * **注意**: 爬取过程可能因为网络问题或微博的反爬机制中断，需要有耐心并可能需要重试。

4.  **执行数据分析**:
    * 将 `合并最终结果.py` 生成的Excel文件和日本官方发布的游客数据（如 `JPVisit.xlsx`）放置在 `data_processing` 目录下。
    * 运行 `rispscore_output.py` 来计算RPIS得分，会生成 `Monthly_RPIS.xlsx`。
    * 运行 `eventanalysis.py` 来执行事件分析和可视化，确保字体路径 `font_path` 在您的系统中有效，以正常显示中文图表。

## 5. 主要发现

1.  **风险感知的短期影响**: 在日本政府宣布核废水排放计划后，游客的风险感知（RPIS得分）在短期内上升，而游客人数有所下降。然而，这种影响似乎并未持续，游客人数随后逐步回升。
2.  **风险感知的“正常化”**: 尽管核废水排放客观上增加了环境风险，但游客赴日人数并未因此持续减少，反而显著超出预期。这表明随着时间推移，公众对风险的认知可能逐渐“正常化”，或被其他因素（如旅游吸引力、疫情后需求反弹）所抵消。
3.  **社交媒体情感的抑制作用**: 回归分析表明，RPIS得分与旅游人数的异常变化呈显著负相关。这意味着，即使总体旅游趋势向上，社交媒体中更强烈的风险感知仍然对游客决策产生可衡量的抑制作用。

## 6. 后续研究方向

本研究仍存在一些不足，未来将从以下方向进行完善：

* **数据补充与修正**: 重新爬取缺失数据，并优化风险词典和分词过程以提高RPIS计算的准确性。
* **完善事件研究法框架**: 严格按照事件研究法设定事件窗口和估计窗口，并对结果进行统计显著性检验。
* **引入更多分析工具**: 应用**Diebold-Mariano检验**等方法评估不同数据的预测能力。
* **考虑多因素交叉影响**: 将汇率波动、免签政策、疫情结束等外部因素纳入模型，进行更全面的交叉分析。